<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/9d0690b173.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="./src/style.css"> 
    <title>m</title>
</head>
<body>
  <div id="app" >

    <div v-if="pageLoading" class="page-loader">
      <div class="spinner-border text-pink" role="status"></div>
      <p class="mt-2 text-white">載入中…</p>
    </div>




    
    <div class=" all m-0 p-0">

      <nav class="navbar sticky-top bg-body-tertiary" style="box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;">
        <div class="container-fluid">
          <a class="navbar-brand tw-7" href="./index.html" style="color: #f460a6;"><i class="fa-solid fa-web-awesome me-2"></i>AIPRI</a>
        </div>
      </nav>

      

      <div class="container-fluid profile my-5">
        
        
        <div class="row d-flex align-items-center justify-content-center ">
          <div class="col-10 p-0 mb-3 d-flex align-items-center justify-content-between">
            <h3 class="m-0" style="font-size: 4.5vw;color: #f460a6;"><i class="fa-solid fa-bars me-2"></i>紀錄</h3>
            <button class="btn btn-primary" type="button" style="background-color: #9eb4e9; border-color: #9eb4e9;" data-bs-toggle="modal" data-bs-target="#exampleModal"><i class="fa-solid fa-plus me-2"></i>增加</button>

          </div>

          <div class="col-10 p-0 mb-3">
            <select class="form-select" v-model="month_rec" @change="fetchByMonth">
                
              <option :value="i" v-for="i in monthList">{{i}}</option>
              
              
            </select>
          </div>
            <div class="col-10 p-0 my-1">
              <p class="m-0 p-0">本月遊玩：{{record.length}}</p>
            </div>
          <div v-if="record.length" class="row d-flex justify-content-center p-0" >
            
            <div class="col-10 accordion p-0 my-1" v-for="(i,index) in record" :key="index">
              <div class="accordion-item" style="box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 5px;">
                
                <h2 class="accordion-header">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    :data-bs-target="'#panelsStayOpen-collapse' + index"
                    aria-expanded="false"
                    :aria-controls="'panelsStayOpen-collapse' + index"
                  >
                  <div >
                    <p class="p-0 m-0">{{ i.title }}</p>
                    <p class="p-0 m-0 pb-1" style="color: #f6d604;"><i class="fa-solid fa-star me-1" v-for="i in i.star"></i></p>
  
                    <p class="p-0 m-0 text-secondary" style="font-size: 12px;"><i class="fa-solid fa-calendar me-2"></i>{{ i.time }}　｜　<i class="fa-solid fa-location-dot me-2"></i>{{ i.place }}</p>
                   
                  </div>
                  </button>
                </h2>
            
                <div
                  :id="'panelsStayOpen-collapse' + index"
                  class="accordion-collapse collapse"
                >
                  <div class="accordion-body">
                    
                    
                    
                    <p v-if="!i.edit"  style="white-space: pre-line;">{{i.description}}</p>
                    <div v-else class="row">
  
                      <div class="col-12 mb-2 p-0">
                        <input type="text" class="form-control m-0" v-model="i.title">
                      </div>
  
                      <div class="col-6 mb-2 p-0 pe-1">
                        <input type="date" class="form-control m-0" v-model="i.time">
                      </div>
                    
                      <div class="col-6 mb-2 p-0 ps-1">
                        <input type="number" class="form-control m-0" v-model.number="i.star">
                      </div>
                    
                      <div class="col-12 mb-2 p-0">
                        <input type="text" class="form-control m-0" v-model="i.place">
                      </div>
                    
                      <div class="col-12 p-0">
                        <textarea class="form-control m-0" v-model="i.description"></textarea>
                      </div>
  
                    </div>
                    <hr>
                    <div class="body-actions text-secondary d-flex align-items-center justify-content-end">
                      <button v-if="!i.edit" class="btn btn-primary me-2" type="button" style="background-color: #f460a6; border-color: #f460a6;" @click="editRow(i.id)"><i class="fa-solid fa-pen-to-square me-2"></i>編輯</button>
                      <button v-else class="btn btn-primary" type="button" style="background-color: #f460a6; border-color: #f460a6;" @click="finishEdit(i)"><i class="fa-solid fa-check me-2"></i>完成</button>
  
                      <button v-if="!i.edit" class="btn btn-primary" type="button" style="background-color: #f460a6; border-color: #f460a6;" @click="deleteRow(i.id)"><i class="fa-solid fa-trash me-2"></i>刪除</button>                 
  
                      
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div v-else class="row d-flex  justify-content-center p-0" style="min-height: 60vh;">
            目前沒有資料
          </div>

        </div>

        
        
      </div>

      <!--
      <div class="rec_insert text-white" data-bs-toggle="modal" data-bs-target="#exampleModal">
        <i class="fa-solid fa-plus"></i>
      </div>
  -->
  
      <nav class="navbar sticky-bottom "  style="background-color: #e0b1c1;">
        <div class="container-fluid">
          
          <ul class="m-0 p-0 mx-3">
            <li><a class="navbar-brand text-white m-0 py-1" href="./index.html"><i class="fa-solid fa-person"></i><p class="m-0 p-0 tw-7">首頁</p></a></li>
            <li><a class="navbar-brand text-white m-0 py-1" href="./album.html" ><i class="fa-solid fa-camera"></i><p class="m-0 p-0 tw-7">相簿</p></a></li>
            <li class="qr"><a class="navbar-brand m-0 py-1" data-bs-target="#myqrcode" data-bs-toggle="modal" style="color: #f460a6;"><i class="fa-solid fa-qrcode "></i><p class="m-0 p-0 tw-7">專屬QR</p></a></li>
            <li><a class="navbar-brand text-white m-0 py-1" href="./collection.html"><i class="fa-solid fa-award"></i><p class="m-0 p-0 tw-7">收集</p></a></li>
            <li><a class="navbar-brand text-white m-0 py-1" href="./record.html"><i class="fa-solid fa-bars"></i><p class="m-0 p-0 tw-7">紀錄</p></a></li>
          </ul>
        </div>
      </nav>

    </div>


    <div class="modal fade" id="myqrcode" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content bg-pink">
          <div class="modal-header bg-pink" style="background-color: #f460a6;">
            
            <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body d-flex align-items-center justify-content-center" style="flex-direction: column;">
            <div id="carouselExample" class="carousel slide">
            <div class="carousel-inner">
              <div class="carousel-item" v-for="(file, i) in allqr" :key="i" :class="{ active: i === 0 }">
                <img :src="file.url" class="d-block h-100 w-75 mx-auto" alt="">
                <div class="text-center">{{ file.name }}</div>
              </div>
            </div>
            
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>


            
            
          </div>
          
        </div>
      </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body row">
                <div class="my-1 col-12">
                    <label class="p-0 col-form-label">標題</label>
                    <input type="text" class="form-control" v-model="upload_title">
                </div>
                <div class="my-1">
                  <label class="p-0 col-form-label">遊玩日期</label>
                  <input type="date" class="form-control" v-model="upload_time">
                </div>
                <div class="my-1 col-6">
                    <label class="p-0 col-form-label">過關得分</label>
                    <input type="number" class="form-control" v-model="upload_star">
                </div>
                <div class="my-1 col-6">
                  <label class="p-0 col-form-label">投卡數量</label>
                  <input type="number" class="form-control" v-model="upload_play">
                </div>
                <div class="my-1">
                    <label class="p-0 col-form-label">遊玩店鋪</label>
                    <input type="text" class="form-control" v-model="upload_place">
                </div>
                
                <div class="my-1">
                    <label class="p-0 col-form-label">紀錄文字</label>
                    <textarea class="form-control" v-model="upload_description"></textarea>
                </div>

                <div class="my-1">




                  <button class="btn w-100 btn-primary my-2" @Click="insert" :disabled="loading" type="button" style="background-color: #9eb4e9; border-color: #9eb4e9;">
                    <span v-if="loading">
                      <div class="spinner-border spinner-border-sm me-2" style="color: #fff" role="status"></div>
                      處理中…
                    </span>
                  
                    <span v-else>上傳</span>
                  </button>
                  
              </div>

            </div>
            
          </div>
        </div>
      </div>

    

    <div v-for="(i,index) in record" class="modal fade" :id="'m' + index" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header" style="background-color: #f460a6;">
            
            <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            {{i}}
            <div>
              <button class="btn text-white" type="button" style="background-color: #9eb4e9; border-color: #9eb4e9;">編輯</button>
              <button class="btn text-white" type="button" style="background-color: #9eb4e9; border-color: #9eb4e9;">刪除</button>

            </div>

          
            
          </div>
        </div>
      </div>
    </div>


   
    
  </div>
    

    
</body>

<script src="./src/app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

</html>